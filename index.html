<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Revolution Macro Guide</title>

  <!-- StackEdit base typography -->
  <link rel="stylesheet" href="https://stackedit.io/style.css" />

  <!-- Favicon (inline SVG) -->
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cdefs%3E%3CradialGradient id='g' cx='50%25' cy='40%25' r='70%25'%3E%3Cstop offset='0%25' stop-color='%2324f0ff' stop-opacity='1'/%3E%3Cstop offset='60%25' stop-color='%2324f0ff' stop-opacity='.35'/%3E%3Cstop offset='100%25' stop-color='%23090b10' stop-opacity='1'/%3E%3C/radialGradient%3E%3C/defs%3E%3Crect width='64' height='64' rx='14' fill='url(%23g)'/%3E%3Cpath d='M18 40c7-12 12-17 18-17 6 0 9 4 10 10-2 10-8 15-18 15-5 0-8-2-10-8z' fill='%23090b10' opacity='.9'/%3E%3Cpath d='M20 38c6-10 10-14 16-14 5 0 7 3 8 8-2 8-7 12-16 12-4 0-6-2-8-6z' fill='%2324f0ff' opacity='.9'/%3E%3C/svg%3E" />

  <style>
    :root{
      /* Requested page blue (tweak here if you want it slightly lighter/darker) */
      --pageBlue: #0b78ff;

      --panel: rgba(12, 14, 18, 0.86);
      --panel2: rgba(20, 24, 33, 0.72);
      --text: #e9e9ea;
      --muted: rgba(233,233,234,0.74);

      --neon: #24f0ff;
      --neonSoft: rgba(36,240,255,0.18);

      --stroke: rgba(255,255,255,0.16);
      --stroke2: rgba(36,240,255,0.32);

      --shadow: 0 18px 46px rgba(0,0,0,0.28);
      --shadow2: 0 10px 28px rgba(0,0,0,0.22);

      /* JS keeps this up-to-date from header.offsetHeight */
      --headerH: 96px;

      /* Sidebar */
      --navW: 180px;
      --navGap: 18px;
      --navRadius: 18px;

      --maxW: 1120px;
    }

    *{ box-sizing: border-box; }
    html{ scroll-behavior: auto; }

    body{
      margin:0;
      font-family: Arial, sans-serif;
      color: var(--text);
      min-height: 100vh;

      /* Premium background */
      background:
        radial-gradient(1200px 740px at 18% 10%, rgba(36,240,255,0.14), transparent 60%),
        radial-gradient(900px 640px at 85% 25%, rgba(36,240,255,0.10), transparent 55%),
        linear-gradient(160deg, rgba(255,255,255,0.05), rgba(0,0,0,0.12)),
        var(--pageBlue);
    }

    /* ======================= SINGLE HEADER (fixed) ======================= */
    .app-header{
      position: fixed;
      top:0; left:0; right:0;
      z-index: 9999;
      padding: 14px 18px 12px;
      background: rgba(10, 12, 16, 0.88);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid rgba(255,255,255,0.12);
      box-shadow: 0 14px 30px rgba(0,0,0,0.25);
    }
    .app-header::after{
      content:"";
      position:absolute;
      left:0; right:0; bottom:-1px;
      height:1px;
      background: linear-gradient(90deg, transparent, rgba(36,240,255,0.40), transparent);
      pointer-events:none;
    }

    .header-row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 14px;
      min-height: 44px;
    }

    .brand-wrap{
      display:flex;
      align-items:baseline;
      gap:10px;
      min-width: 220px;
      white-space: nowrap;
    }

    .brand-title{
      font-weight: 900;
      letter-spacing: 0.2px;
      font-size: 18px;
      display:flex;
      align-items:baseline;
      gap:10px;
    }
    .brand-title .brand{
      color: var(--text);
      text-shadow: 0 0 18px rgba(255,255,255,0.06);
    }

    .typingWrap{
      display:inline-flex;
      align-items:baseline;
      gap:4px;
      min-width: 220px; /* prevents header layout shift */
    }
    .typing{
      color: var(--neon);
      text-shadow: 0 0 16px rgba(36,240,255,0.30);
      font-weight: 900;
    }
    .caret{
      display:inline-block;
      color: var(--neon);
      opacity: 0.95;
      transform: translateY(1px);
      animation: blink 1s steps(1, end) infinite;
      text-shadow: 0 0 16px rgba(36,240,255,0.30);
    }
    @keyframes blink{ 50%{ opacity: 0; } }

    .header-actions{
      display:flex;
      align-items:center;
      gap:10px;
      flex-wrap: wrap;
      justify-content:flex-end;
    }

    .pill-link{
      text-decoration:none;
      color: var(--text);
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(15,17,21,0.62);
      padding: 10px 14px;
      border-radius: 14px;
      box-shadow: 0 10px 22px rgba(0,0,0,0.18);
      transition: transform .15s ease, border-color .15s ease, background .15s ease;
      display:inline-flex;
      align-items:center;
      gap: 8px;
      user-select:none;
      cursor:pointer;
    }
    .pill-link:hover{
      transform: translateY(-1px);
      border-color: rgba(36,240,255,0.35);
      background: rgba(15,17,21,0.78);
    }

    /* Mobile hamburger */
    .hamburger{
      display:none;
      width: 42px;
      height: 42px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(15,17,21,0.62);
      color: var(--neon);
      cursor:pointer;
      align-items:center;
      justify-content:center;
      box-shadow: 0 10px 22px rgba(0,0,0,0.18);
      transition: transform .15s ease, border-color .15s ease, background .15s ease;
    }
    .hamburger:hover{
      transform: translateY(-1px);
      border-color: rgba(36,240,255,0.35);
      background: rgba(15,17,21,0.78);
    }

    /* Tabs row stays inside header */
    .header-tabs{
      display:flex;
      align-items:flex-end;
      gap:10px;
      padding-top: 10px;
      flex-wrap: wrap;
    }

    .tab-btn{
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(15,17,21,0.55);
      color: var(--text);
      padding: 10px 14px;
      border-radius: 14px;
      cursor:pointer;
      transition: transform .15s ease, border-color .15s ease, background .15s ease;
      font-size: 15px;
      user-select:none;
      display:inline-flex;
      align-items:center;
      gap:8px;
    }
    .tab-btn:hover{
      transform: translateY(-1px);
      border-color: rgba(36,240,255,0.35);
      background: rgba(15,17,21,0.72);
    }
    .tab-btn.active{
      border-color: rgba(36,240,255,0.52);
      box-shadow: 0 0 0 1px rgba(36,240,255,0.18) inset, 0 0 26px rgba(36,240,255,0.10);
    }
    .tab-dot{
      width: 8px; height: 8px;
      border-radius: 999px;
      background: rgba(255,255,255,0.25);
      box-shadow: 0 0 0 2px rgba(0,0,0,0.2) inset;
    }
    .tab-btn.active .tab-dot{
      background: var(--neon);
      box-shadow: 0 0 18px rgba(36,240,255,0.35);
    }

    /* ======================= APP LAYOUT ======================= */
    .app{
      padding-top: calc(var(--headerH) + 18px);
      padding-left: 18px;
      padding-right: 18px;
      padding-bottom: 28px;
    }

    .layout{
      display:grid;
      grid-template-columns: var(--navW) minmax(0, 1fr);
      gap: var(--navGap);
      max-width: calc(var(--maxW) + var(--navW) + var(--navGap));
      margin: 0 auto;
      align-items:start;
    }
    .layout.no-side{
      grid-template-columns: minmax(0, 1fr);
    }

    /* ======================= SIDEBAR ======================= */
    .side{
      width: var(--navW);
      position: sticky;
      top: calc(var(--headerH) + 18px);
      align-self:start;

      border-radius: var(--navRadius);
      background:
        linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.04)),
        rgba(3, 102, 252, 0.22);
      border: 1px solid rgba(255,255,255,0.14);
      box-shadow: var(--shadow2);
      overflow:hidden;
    }

    .side-header{
      padding: 14px 12px 10px;
      border-bottom: 1px solid rgba(255,255,255,0.10);
      position:relative;
    }
    .side-header::after{
      content:"";
      position:absolute;
      left:10px; right:10px; bottom:-1px;
      height:1px;
      background: linear-gradient(90deg, transparent, rgba(36,240,255,0.35), transparent);
      pointer-events:none;
    }
    .side-title{
      font-size: 13px;
      letter-spacing: 1px;
      font-weight: 900;
      text-transform: uppercase;
      color: rgba(233,233,234,0.88);
      text-shadow: 0 0 16px rgba(36,240,255,0.10);
    }

    .side-links{
      padding: 12px 10px 10px;
      display:flex;
      flex-direction:column;
      gap: 10px;
    }

    .side-links a,
    .side-links button{
      display:block;
      width:100%;
      text-decoration:none;
      text-align:left;
      color: rgba(233,233,234,0.94);
      font-weight: 900;
      padding: 10px 10px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.16);
      background: rgba(15,17,21,0.55);
      box-shadow: 0 8px 20px rgba(0,0,0,0.15);
      transition: transform .15s ease, border-color .15s ease, background .15s ease;
      user-select:none;
      cursor:pointer;
    }
    .side-links a:hover,
    .side-links button:hover{
      transform: translateY(-1px);
      border-color: rgba(36,240,255,0.32);
      background: rgba(15,17,21,0.70);
    }
    .side-links a.active{
      color: var(--neon);
      border-color: rgba(36,240,255,0.55);
      box-shadow: 0 0 0 1px rgba(36,240,255,0.12) inset, 0 0 26px rgba(36,240,255,0.10);
      text-shadow: 0 0 16px rgba(36,240,255,0.20);
    }

    .side-footer{
      padding: 0 10px 14px;
    }

    /* Sidebar top button now lives here */
    #sideTopBtn{
      margin-top: 10px;
      display:flex;
      align-items:center;
      justify-content:center;
      text-align:center;
      font-weight: 1000;
    }

    /* ======================= MAIN PANEL ======================= */
    .panel{
      border: 1px solid rgba(255,255,255,0.16);
      border-radius: 18px;
      background: rgba(15, 17, 21, 0.86);
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
      padding: 18px;
      overflow:hidden;
      min-height: 320px;
    }

    .tab-content{ display:none; }
    .tab-content.active{ display:block; animation: fadeInUp 220ms ease both; }
    @keyframes fadeInUp{
      from{ opacity: 0; transform: translateY(6px); }
      to{ opacity: 1; transform: translateY(0); }
    }

    /* StackEdit content legibility */
    .stackedit__html{ color: var(--text); }
    .stackedit__html h1, .stackedit__html h2, .stackedit__html h3, .stackedit__html h4,
    .stackedit__html p, .stackedit__html li{ color: var(--text); }
    .stackedit__html a{
      color: var(--text);
      text-decoration: underline;
      text-decoration-color: rgba(36,240,255,0.35);
    }

    /* Premium code blocks + copy button */
    pre{
      position: relative;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,0.16);
      background: rgba(10,12,16,0.72);
      box-shadow: 0 10px 24px rgba(0,0,0,0.20);
      padding: 14px;
      overflow: auto;
    }
    pre code{
      color: var(--text);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 13px;
      line-height: 1.5;
    }
    .copy-btn{
      position:absolute;
      top:10px;
      right:10px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(15,17,21,0.70);
      color: rgba(233,233,234,0.92);
      padding: 8px 10px;
      cursor:pointer;
      font-weight: 900;
      font-size: 12px;
      transition: transform .15s ease, border-color .15s ease, background .15s ease;
      user-select:none;
    }
    .copy-btn:hover{
      transform: translateY(-1px);
      border-color: rgba(36,240,255,0.35);
      background: rgba(15,17,21,0.85);
    }
    .copy-btn.copied{
      color: var(--neon);
      border-color: rgba(36,240,255,0.55);
      box-shadow: 0 0 18px rgba(36,240,255,0.10);
    }

    /* ======================= TROUBLESHOOTING UX ======================= */
    .ts-head{
      margin-bottom: 10px;
    }
    .ts-title{
      margin: 0;
      font-size: 26px;
      font-weight: 1000;
      letter-spacing: 0.2px;
    }
    .ts-sub{
      margin: 8px 0 0;
      color: var(--muted);
      line-height: 1.35;
      max-width: 720px;
    }
    /* Remove any accidental “thin line” under troubleshooting by not adding extra borders here */

    .ts-toolbar{
      display:flex;
      flex-wrap: wrap;
      align-items:center;
      gap: 10px;
      margin: 14px 0 14px;
    }

    .ts-search{
      flex: 1;
      min-width: 220px;
      display:flex;
      gap: 10px;
      align-items:center;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.16);
      background: rgba(10,12,16,0.48);
    }
    .ts-search input{
      width:100%;
      border:none;
      outline:none;
      background: transparent;
      color: var(--text);
      font-size: 15px;
    }
    .ts-search .icon{
      color: rgba(233,233,234,0.65);
      font-weight: 900;
    }

    .ts-filter-pill{
      border: 1px solid rgba(255,255,255,0.16);
      background: rgba(15,17,21,0.55);
      color: rgba(233,233,234,0.92);
      padding: 10px 12px;
      border-radius: 14px;
      cursor:pointer;
      font-weight: 1000;
      transition: transform .15s ease, border-color .15s ease, background .15s ease;
      user-select:none;
      white-space: nowrap;
    }
    .ts-filter-pill:hover{
      transform: translateY(-1px);
      border-color: rgba(36,240,255,0.35);
      background: rgba(15,17,21,0.72);
    }
    .ts-filter-pill.active{
      color: var(--neon);
      border-color: rgba(36,240,255,0.55);
      box-shadow: 0 0 0 1px rgba(36,240,255,0.12) inset, 0 0 26px rgba(36,240,255,0.10);
    }

    .cat-grid{
      display:grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 12px;
      margin: 14px 0 14px;
    }

    .cat-card{
      border: 1px solid rgba(36,240,255,0.22);
      border-radius: 16px;
      background: rgba(10,12,16,0.42);
      padding: 14px;
      cursor:pointer;
      box-shadow: 0 10px 22px rgba(0,0,0,0.18);
      transition: transform .15s ease, border-color .15s ease, background .15s ease;
      position: relative;
      overflow:hidden;
      user-select:none;
    }
    .cat-card::before{
      content:"";
      position:absolute;
      inset:-40px;
      background: radial-gradient(520px 180px at 20% 20%, rgba(36,240,255,0.18), transparent 60%);
      opacity: 0.9;
      pointer-events:none;
    }
    .cat-card:hover{
      transform: translateY(-2px);
      border-color: rgba(36,240,255,0.40);
      background: rgba(10,12,16,0.55);
    }
    .cat-card.active{
      border-color: rgba(36,240,255,0.62);
      box-shadow: 0 0 0 1px rgba(36,240,255,0.14) inset, 0 0 34px rgba(36,240,255,0.12);
    }

    .cat-title{
      font-weight: 1000;
      font-size: 18px;
      color: var(--text);
    }
    .cat-sub{
      color: var(--muted);
      margin-top: 6px;
      font-size: 13px;
      line-height: 1.25;
    }

    .issues-wrap{
      margin-top: 10px;
      display:flex;
      flex-direction:column;
      gap: 12px;
    }

    .issue-block{
      border: 1px solid rgba(255,255,255,0.14);
      border-radius: 16px;
      background: rgba(10,12,16,0.44);
      overflow:hidden;
      box-shadow: 0 10px 22px rgba(0,0,0,0.16);
    }

    .issue-title{
      width: 100%;
      text-align:left;
      appearance:none;
      border:none;
      background: transparent;
      color: var(--text);
      padding: 14px;
      font-size: 16px;
      font-weight: 1000;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      user-select:none;
    }
    .issue-title:hover{
      background: rgba(15,17,21,0.35);
    }

    .issue-title .chev{
      color: rgba(233,233,234,0.70);
      font-weight: 1000;
      transition: transform .15s ease;
    }

    .issue-body{
      display:none;
      padding: 0 14px 14px;
      color: rgba(233,233,234,0.92);
      line-height: 1.45;
    }
    .issue-body.open{
      display:block;
      animation: fadeInUp 180ms ease both;
    }

    .empty{
      padding: 14px;
      color: rgba(233,233,234,0.70);
      border: 1px dashed rgba(255,255,255,0.18);
      border-radius: 16px;
      background: rgba(10,12,16,0.30);
    }

    /* Mobile floating top button (sidebar has top button on desktop) */
    #backToTopMobile{
      position: fixed;
      right: 18px;
      bottom: 18px;
      z-index: 999;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(10,12,16,0.72);
      color: rgba(233,233,234,0.92);
      cursor:pointer;
      display:none;
      box-shadow: 0 10px 22px rgba(0,0,0,0.20);
    }
    #backToTopMobile:hover{
      border-color: rgba(36,240,255,0.35);
      color: var(--neon);
    }

    /* ======================= MOBILE / RESPONSIVE ======================= */
    @media (max-width: 980px){
      .layout{ grid-template-columns: minmax(0, 1fr); }
      .side{ display:none; }
      .hamburger{ display:inline-flex; }

      .cat-grid{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
    }

    @media (max-width: 560px){
      .brand-wrap{ min-width: 0; }
      .typingWrap{ min-width: 160px; }
      .cat-grid{ grid-template-columns: 1fr; }

      .pill-link{ padding: 10px 12px; }
      .tab-btn{ padding: 10px 12px; }
    }

    /* ======================= SIDEBAR DRAWER (mobile) ======================= */
    .drawer-backdrop{
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.45);
      backdrop-filter: blur(3px);
      z-index: 9998;
      display:none;
    }
    .drawer{
      position: fixed;
      top: var(--headerH);
      left: 12px;
      width: min(280px, calc(100vw - 24px));
      max-height: calc(100vh - var(--headerH) - 12px);
      overflow:auto;
      z-index: 9999;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,0.14);
      background:
        linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.04)),
        rgba(3, 102, 252, 0.22);
      box-shadow: var(--shadow);
      display:none;
    }
    .drawer.open,
    .drawer-backdrop.open{
      display:block;
      animation: fadeInUp 160ms ease both;
    }

  </style>
</head>

<body>
  <!-- Mobile drawer -->
  <div id="drawerBackdrop" class="drawer-backdrop" aria-hidden="true"></div>
  <div id="drawer" class="drawer" aria-hidden="true">
    <div class="side-header">
      <div class="side-title">Quick Jump</div>
    </div>
    <div id="drawerLinks" class="side-links"></div>
    <div class="side-footer">
      <button id="drawerTopBtn" type="button">Top</button>
    </div>
  </div>

  <!-- SINGLE header -->
  <header class="app-header" id="appHeader">
    <div class="header-row">
      <div class="brand-wrap">
        <button id="hamburger" class="hamburger" title="Open Quick Jump" aria-label="Open Quick Jump">☰</button>

        <div class="brand-title">
          <span class="brand">Revolution Macro</span>
          <span class="typingWrap">
            <span class="typing" id="typingWord"></span><span class="caret" id="typingCaret">|</span>
          </span>
        </div>
      </div>

      <div class="header-actions">
        <a class="pill-link" href="https://github.com/RevolutionGuides/revolutionmacroguide/issues" target="_blank" rel="noopener noreferrer">
          Open Issues
        </a>
        <a class="pill-link" href="https://github.com/RevolutionGuides/revolutionmacroguide/issues/new?template=troubleshooting.yml" target="_blank" rel="noopener noreferrer">
          Submit Fix
        </a>
      </div>
    </div>

    <div class="header-tabs">
      <button class="tab-btn active" id="tabGuideBtn" type="button" data-tab="guide">
        <span class="tab-dot"></span> Clickpath Guide
      </button>
      <button class="tab-btn" id="tabTroubleBtn" type="button" data-tab="troubleshooting">
        <span class="tab-dot"></span> Troubleshooting
      </button>
    </div>
  </header>

  <main class="app">
    <div class="layout" id="layout">
      <!-- Sidebar (Guide only) -->
      <aside id="side" class="side" aria-label="Quick Jump">
        <div class="side-header">
          <div class="side-title">Quick Jump</div>
        </div>

        <!-- EXACTLY 6 items -->
        <nav id="guideNav" class="side-links"></nav>

        <div class="side-footer">
          <button id="sideTopBtn" type="button">Top</button>
        </div>
      </aside>

      <!-- Main content -->
      <section class="main">
        <div class="panel">
          <!-- GUIDE TAB -->
          <div id="guide" class="tab-content active">
            <div class="stackedit__html" id="guideContent"></div>
          </div>

          <!-- TROUBLESHOOTING TAB -->
          <div id="troubleshooting" class="tab-content">
            <div class="ts-head">
              <h2 class="ts-title">Troubleshooting</h2>
              <p class="ts-sub">
                Pick a category, search within it, and expand an entry for the exact fix. If you found a new solution, submit it using the button in the header.
              </p>
            </div>

            <!-- Category cards (no emojis) -->
            <div class="cat-grid" id="catGrid">
              <div class="cat-card" data-cat="mac">
                <div class="cat-title">Mac</div>
                <div class="cat-sub">Accessibility, permissions, macOS fixes</div>
              </div>
              <div class="cat-card" data-cat="windows">
                <div class="cat-title">Windows</div>
                <div class="cat-sub">Capture mode, drivers, Windows fixes</div>
              </div>
              <div class="cat-card" data-cat="macro">
                <div class="cat-title">Macro</div>
                <div class="cat-sub">Settings, patterns, routing, resets</div>
              </div>
              <div class="cat-card" data-cat="pro">
                <div class="cat-title">Pro</div>
                <div class="cat-sub">Advanced tips, high efficiency setups</div>
              </div>
            </div>

            <!-- Search + filters -->
            <div class="ts-toolbar">
              <div class="ts-search" title="Search current category">
                <span class="icon">Search</span>
                <input id="tsSearch" type="text" placeholder="Search fixes..." />
              </div>

              <button id="allCatsBtn" class="ts-filter-pill active" type="button">All</button>
              <button class="ts-filter-pill" type="button" data-filter="mac">Mac</button>
              <button class="ts-filter-pill" type="button" data-filter="windows">Windows</button>
              <button class="ts-filter-pill" type="button" data-filter="macro">Macro</button>
              <button class="ts-filter-pill" type="button" data-filter="pro">Pro</button>
            </div>

            <!-- Issues list -->
            <div id="issues" class="issues-wrap"></div>
          </div>
        </div>
      </section>
    </div>
  </main>

  <!-- Mobile-only floating top button -->
  <button id="backToTopMobile" type="button">Top</button>

  <!-- Markdown renderer -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <script>
    /**********************
     * Keep CSS --headerH synced to actual header height (fixes tab overflow + offsets)
     **********************/
    function syncHeaderHeight(){
      const header = document.getElementById("appHeader");
      if (!header) return;
      const h = header.offsetHeight || 96;
      document.documentElement.style.setProperty("--headerH", h + "px");
    }
    window.addEventListener("resize", syncHeaderHeight);

    /**********************
     * Smooth scroll with header offset (no jumping)
     **********************/
    function scrollToWithOffset(el){
      if (!el) return;
      syncHeaderHeight();
      const header = document.getElementById("appHeader");
      const offset = (header ? header.offsetHeight : 0) + 14;
      const y = el.getBoundingClientRect().top + window.pageYOffset - offset;
      window.scrollTo({ top: y, behavior: "smooth" });
    }

    /**********************
     * Tabs
     **********************/
    const layout = document.getElementById("layout");
    const side = document.getElementById("side");

    function openTab(tabId){
      document.querySelectorAll(".tab-content").forEach(el => el.classList.remove("active"));
      document.querySelectorAll(".tab-btn").forEach(b => b.classList.remove("active"));

      const active = document.getElementById(tabId);
      if (active) active.classList.add("active");

      const btn = document.querySelector(\`.tab-btn[data-tab="\${tabId}"]\`);
      if (btn) btn.classList.add("active");

      // Sidebar visible only for guide tab (and layout should fill when hidden)
      const showNav = (tabId === "guide");
      if (showNav){
        side.style.display = "block";
        layout.classList.remove("no-side");
      } else {
        side.style.display = "none";
        layout.classList.add("no-side");
      }

      closeDrawer();

      if (tabId === "troubleshooting") ensureIssuesLoaded();

      // Keep header offsets correct
      syncHeaderHeight();
    }

    document.getElementById("tabGuideBtn").addEventListener("click", () => openTab("guide"));
    document.getElementById("tabTroubleBtn").addEventListener("click", () => openTab("troubleshooting"));

    /**********************
     * Mobile Drawer
     **********************/
    const drawer = document.getElementById("drawer");
    const drawerBackdrop = document.getElementById("drawerBackdrop");
    const hamburger = document.getElementById("hamburger");

    function openDrawer(){
      syncHeaderHeight();
      drawer.classList.add("open");
      drawerBackdrop.classList.add("open");
      drawer.setAttribute("aria-hidden", "false");
      drawerBackdrop.setAttribute("aria-hidden", "false");
    }
    function closeDrawer(){
      drawer.classList.remove("open");
      drawerBackdrop.classList.remove("open");
      drawer.setAttribute("aria-hidden", "true");
      drawerBackdrop.setAttribute("aria-hidden", "true");
    }

    hamburger.addEventListener("click", () => {
      if (drawer.classList.contains("open")) closeDrawer();
      else openDrawer();
    });
    drawerBackdrop.addEventListener("click", closeDrawer);

    /**********************
     * Top buttons (sidebar + drawer + mobile floating)
     **********************/
    function goTop(){ window.scrollTo({ top: 0, behavior: "smooth" }); }

    document.getElementById("sideTopBtn").addEventListener("click", goTop);
    document.getElementById("drawerTopBtn").addEventListener("click", () => { goTop(); closeDrawer(); });

    const backToTopMobile = document.getElementById("backToTopMobile");
    window.addEventListener("scroll", () => {
      // only show on mobile (sidebar hidden)
      const isMobile = window.matchMedia("(max-width: 980px)").matches;
      backToTopMobile.style.display = (isMobile && window.scrollY > 380) ? "block" : "none";
    });
    backToTopMobile.addEventListener("click", goTop);

    /**********************
     * Typewriter (slower, caret stays right after text naturally)
     **********************/
    (function titleTypewriter(){
      const el = document.getElementById("typingWord");
      if (!el) return;

      const words = ["Guide", "Troubleshooting Help"];
      let w = 0, i = 0, deleting = false;

      function tick(){
        const word = words[w];

        if (!deleting){
          i++;
          el.textContent = word.slice(0, i);
          if (i >= word.length){
            deleting = true;
            return setTimeout(tick, 1600);
          }
          return setTimeout(tick, 120); // slower typing
        } else {
          i--;
          el.textContent = word.slice(0, i);
          if (i <= 0){
            deleting = false;
            w = (w + 1) % words.length;
            return setTimeout(tick, 560);
          }
          return setTimeout(tick, 85); // slower delete
        }
      }
      tick();
    })();

    /**********************
     * GUIDE CONTENT (verbatim)
     **********************/
    const guideMarkdown = `# Revolution Macro Guide and Fixes

Use this for reference!

**Button/Feature format:**
- *Feature/Button Name*: *What it does*

## version 0.8c (Pre-release 2)

Please note that the macro needs to be at least 1920x1080 - 1366x768 resolution on windows, 100% scale, no HDR and no touchscreen
Default Key Binds:
* START - F1
* PAUSE - F2
* STOP - F3

# Tabs - 6 in total

1. Gather Tab
2. Collect Tab
3. Planters Tab
4. Status Tab
5. Tools Tab
6. Settings Tab

# Gather Tab (1)

## Fields

- To edit a field, click the pen icon, to paste pre-made settings, click the 6 dots icon, and click "Paste". Find pre-made settings in the Discord server -> #patterns-configs
- Editing the Field (Suggested to copy and paste pre-made settings from the Revolution Discord
- Disable drift detection (uses supreme saturator to align character) -> click the pen icon -> click "align" located under max backpack -> disable
- Walk or reset to hive: Skull Symbol and Person walking switch, per field setting

## Boosts

- Make sure your sprinkler is in slot 1
- Configure slots 2-7 to your liking

## Gather settings

### General
- Set sprinkler type to your current sprinkler in Bee Swarm
- If you are blue and macro in Pine tree and have good fps, enable "Use Fast Pine Return Path"
- Disable Gathering: Wait for tasks and prevent the macro from farming honey
- Use Dipper: Hold/Auto click your mouse
- Inactive Honey Timeout: Maximum amount of seconds before the macro stop gathering if no honey is being made, default is 10 seconds
- Full Bag Timeout: Maximum amount of seconds before stopping gathering if your capacity (aka. backpack) is full.

### Drift
- Detect Drift: Detects when you are going away from the center
- Enable Drift Compensation: Uses drift compensation if your character is drifting (also impacts camera drift)
- Enable Camera Drift Compensation: Uses camera drift compensation

### Pathing
- Pattern: Picks the gathering pattern, default is cornerxsnake
- Use Custom Pattern: Make your own gathering pattern
- Use Natro Pattern: Uses natro's pattern
- Use Pattern Annotation: Draws the pattern on your screen
- Use Field Drift Compensation: Uses drift compensation relative to the field

# Collect Tab (2)

## General
- Convert At: When to convert honey in your hive, default is 95%
- Convert: Turns conversion on or off
- Convert On Full: Converts when your bag is full, regardless of convert at
- Convert With 0 Honey: Converts when you have 0 honey (not recommended)
- Convert With 0 Honey Timeout: Maximum amount of seconds before converting with 0 honey
- Reset After Convert: Resets after conversion

## Conversion
- Use Converter: Uses the converter in your hive
- Use Micro Converter: Uses micro converter
- Use Balloon: Uses balloon

## Snowflakes
- Gather Snowflakes: Collects snowflakes

## Puffs
- Enabled: Collects puffs
- Puff Planter Type: Type of planter you are using for puff
- Puff Planter Field: Field where you place puff planter
- Puff Planter Interval: How often to check puffs

# Planters Tab (3)

## Auto planters

### Settings
- Enabled: Turn this on for automatic planters, if not then it's manual mode
- Degradation Multiplier: Default at 1.2x, ranges from 1.0 to 2.0, Encourage the algorithm to switch fields when placing the same planter
- Build Nectars: The popular option is 2 Build and 1 Maintain, you can only have 3 active planters at once
- Harvest Automatic: If disabled, you can choose your own min and max growth time for your planters
- Harvest Fully Grown: Will only harvest when your planters is at 100%

### Nectar Goals
- There are five types of Nectar: Invigorating, Satisfying, Motivating, Comforting and Refreshing
- You can set your own target percentage for each nectars
- You can drag them up or down to swap/change priority level

### Fields
- You can select each fields to enable/disable planting in that field

# Status Tab (4)

## General
- Shows your current status, what the macro is doing

## Stats
- Displays macro statistics, honey per hour, average honey per hour, etc

## Discord
- Discord Rich Presence: Shows your status on discord

# Tools Tab (5)

## General
- Rejoin: Rejoins the server
- Respawn: Respawns your character
- Leave: Leaves the server

## Packs
- Enabled: Collects packs
- Use Natro Pack List: Uses natro's pack list

## Quests
- Enabled: Completes quests
- Use Quest Menu: Uses the quest menu

## Mobs
- Enabled: Kills mobs
- Use Mondo Hop: Hops mondo chick
- Use Vicious Bee Hop: Hops vicious bee

# Settings Tab (6)

## Macro

### Appearance
- Theme: dark mode ofc
- Always On Top: Only enable this if you need to always see the macro app window

### Hotkeys
- Set your Start, Pause, Stop hotkeys here

### Capture
- Fallback Capture Mode: Available options are Window, GPU, Legacy
- Detection Frame Rate: Lower = Less CPU usage, but less accurate buff detection and movement correction

### Misc
- Log Level: Set to 4 for maximum verbose logging (only for debugging), else keep at 0
- Load Timeout: Maximum seconds before aborting loading AI models (default is 30), set this to something high like 60 if your AI models aren't loading

## Game

### Movement
- Player Movespeed: Your BSS movespeed (ingame) WITHOUT any speed buffs
- Camera Sensitivity: Set to your current in-game settings, or press the eye icon for auto detect
- Key Delay: Default at 20ms, Set this higher to 30-50 if you have low FPS
- Pattern Retry Count: How many times should the macro attempt to do navigations before giving up on the task

### Routing
- Use High Alignment: Turn this on if you have low FPS or pathing issues
- Disable Red Cannon: Only turn this on if you can't use the red cannon

### Join
- Preferred Hive Slot: Slot 6 to 1, 6 being closest to noob shop and 1 closest to red cannon
- Hive Claim Method: Default is Detect, set it to Check if it's not working
- Private Server Link: Paste your private server link in here
- Fallback the Public Server: Join public servers if the macro is having trouble joining the private server

## Networking
- Identity: Your current network identity (differs in RDPs)
- Relay: Click start
- Auto-Start: Turn this on if you're constantly using alts
- Auto-Connect: Connect to the relay on start
- Available Relays: Click the plus icon to add a relay, Click the entry icon on your added relay to join it, Click the star icon to your added relay to remove it

## Presets
- WIP.

## Accounts
- WIP.

## Credits
- List of people who helped developed the macro and donators

----
made by draco/imes ^^`;

    document.getElementById("guideContent").innerHTML = marked.parse(guideMarkdown);

    /**********************
     * Copy buttons on code blocks
     **********************/
    function addCopyButtons(root){
      const blocks = (root || document).querySelectorAll("pre");
      blocks.forEach(pre => {
        if (pre.querySelector(".copy-btn")) return;

        const btn = document.createElement("button");
        btn.className = "copy-btn";
        btn.type = "button";
        btn.textContent = "Copy";

        btn.addEventListener("click", async () => {
          const code = pre.querySelector("code");
          const text = code ? code.innerText : pre.innerText;

          try{
            await navigator.clipboard.writeText(text);
            btn.classList.add("copied");
            btn.textContent = "Copied";
            setTimeout(() => {
              btn.classList.remove("copied");
              btn.textContent = "Copy";
            }, 900);
          }catch(e){
            btn.textContent = "Failed";
            setTimeout(() => (btn.textContent = "Copy"), 900);
          }
        });

        pre.appendChild(btn);
      });
    }
    addCopyButtons(document.getElementById("guideContent"));

    /**********************
     * Sidebar: EXACTLY 6 links (the tabs)
     **********************/
    function slugify(text){
      return (text || "")
        .toLowerCase()
        .replace(/[^a-z0-9\s-]/g, "")
        .trim()
        .replace(/\s+/g, "-");
    }

    function buildSixItemNav(){
      const guideRoot = document.getElementById("guideContent");
      const nav = document.getElementById("guideNav");
      const drawerLinks = document.getElementById("drawerLinks");

      if (!guideRoot || !nav || !drawerLinks) return;

      // Find headings and assign IDs
      const headings = guideRoot.querySelectorAll("h1, h2");
      headings.forEach(h => {
        const txt = (h.textContent || "").trim();
        if (!txt) return;
        h.id = slugify(txt);
      });

      const wanted = [
        { label: "Gather Tab (1)", id: slugify("Gather Tab (1)") },
        { label: "Collect Tab (2)", id: slugify("Collect Tab (2)") },
        { label: "Planters Tab (3)", id: slugify("Planters Tab (3)") },
        { label: "Status Tab (4)", id: slugify("Status Tab (4)") },
        { label: "Tools Tab (5)", id: slugify("Tools Tab (5)") },
        { label: "Settings Tab (6)", id: slugify("Settings Tab (6)") },
      ];

      nav.innerHTML = "";
      drawerLinks.innerHTML = "";

      wanted.forEach(t => {
        const targetEl = document.getElementById(t.id);
        if (!targetEl) return;

        const a = document.createElement("a");
        a.href = "#" + t.id;
        a.dataset.target = t.id;
        a.textContent = t.label;

        a.addEventListener("click", (e) => {
          e.preventDefault();
          scrollToWithOffset(targetEl);
          history.replaceState(null, "", "#" + t.id);
        });

        const b = a.cloneNode(true);
        b.addEventListener("click", (e) => {
          e.preventDefault();
          scrollToWithOffset(targetEl);
          history.replaceState(null, "", "#" + t.id);
          closeDrawer();
        });

        nav.appendChild(a);
        drawerLinks.appendChild(b);
      });

      setupActiveNavTracking(nav, wanted.map(x => x.id));
    }

    function setupActiveNavTracking(nav, ids){
      if (!("IntersectionObserver" in window)) return;
      const links = Array.from(nav.querySelectorAll("a[data-target]"));
      const map = new Map(links.map(a => [a.dataset.target, a]));

      const obs = new IntersectionObserver((entries) => {
        const visible = entries
          .filter(e => e.isIntersecting)
          .sort((a, b) => a.boundingClientRect.top - b.boundingClientRect.top);

        if (!visible.length) return;

        const id = visible[0].target.id;
        links.forEach(a => a.classList.remove("active"));
        const link = map.get(id);
        if (link) link.classList.add("active");
      }, {
        threshold: 0.25,
        rootMargin: "-25% 0px -65% 0px"
      });

      ids.forEach(id => {
        const el = document.getElementById(id);
        if (el) obs.observe(el);
      });
    }

    /**********************
     * Troubleshooting: load + render
     **********************/
    let TROUBLE_CACHE = null;
    let TROUBLE_LOADED = false;

    // Strip emoji shortcodes and obvious emoji characters from titles (you asked: no emojis)
    function stripEmoji(text){
      if (!text) return "";
      return text
        .replace(/:[a-zA-Z0-9_+-]+:/g, "")      // :computer: etc
        .replace(/[\u{1F300}-\u{1FAFF}]/gu, "") // emoji ranges
        .replace(/\s{2,}/g, " ")
        .trim();
    }

    function getRepoContext(){
      return { owner: "RevolutionGuides", repo: "revolutionmacroguide", branch: "main" };
    }

    async function fetchTroubleJson(){
      const { owner, repo, branch } = getRepoContext();
      const cacheBust = Date.now();

      // Pages sometimes won’t serve .github reliably; raw GitHub is safest.
      const tries = [
        `troubleshooting.json?v=${cacheBust}`,
        `https://raw.githubusercontent.com/${owner}/${repo}/${branch}/.github/troubleshooting.json?v=${cacheBust}`,
        `https://raw.githubusercontent.com/${owner}/${repo}/${branch}/troubleshooting.json?v=${cacheBust}`,
      ];

      let lastErr = null;
      for (const url of tries){
        try{
          const res = await fetch(url, { cache: "no-store" });
          if (!res.ok) throw new Error(`Fetch failed (${res.status}) for ${url}`);
          return await res.json();
        }catch(e){
          lastErr = e;
        }
      }
      throw lastErr || new Error("Failed to load troubleshooting.json");
    }

    async function ensureIssuesLoaded(){
      if (TROUBLE_LOADED) return;
      TROUBLE_LOADED = true;

      const container = document.getElementById("issues");
      container.innerHTML = `<div class="empty">Loading fixes…</div>`;

      try{
        const data = await fetchTroubleJson();
        TROUBLE_CACHE = (data || []).map(i => ({
          title: stripEmoji(i.title || "Untitled fix"),
          category: (i.category || "").toLowerCase().trim(),
          solution: (i.solution || ""),
        }));
        renderTroubleshooting();
      }catch(err){
        console.error(err);
        container.innerHTML = `
          <div class="empty">
            Could not load <b>troubleshooting.json</b>.<br><br>
            Quick fix: keep a copy at repo root as <b>/troubleshooting.json</b> OR rely on the raw GitHub URL.
          </div>`;
      }
    }

    let activeCat = "all";
    let searchQ = "";

    const tsSearch = document.getElementById("tsSearch");
    tsSearch.addEventListener("input", (e) => {
      searchQ = (e.target.value || "").toLowerCase();
      renderTroubleshooting();
    });

    document.querySelectorAll(".cat-card").forEach(card => {
      card.addEventListener("click", () => {
        setCategory(card.dataset.cat || "all");
        const issuesEl = document.getElementById("issues");
        if (issuesEl) setTimeout(() => scrollToWithOffset(issuesEl), 40);
      });
    });

    const allCatsBtn = document.getElementById("allCatsBtn");
    allCatsBtn.addEventListener("click", () => setCategory("all"));
    document.querySelectorAll(".ts-filter-pill[data-filter]").forEach(btn => {
      btn.addEventListener("click", () => setCategory(btn.dataset.filter));
    });

    function setCategory(cat){
      activeCat = cat || "all";

      document.querySelectorAll(".ts-filter-pill").forEach(p => p.classList.remove("active"));
      if (activeCat === "all") allCatsBtn.classList.add("active");
      else {
        const pill = document.querySelector(\`.ts-filter-pill[data-filter="\${activeCat}"]\`);
        if (pill) pill.classList.add("active");
      }

      document.querySelectorAll(".cat-card").forEach(c => c.classList.remove("active"));
      if (activeCat !== "all"){
        const card = document.querySelector(\`.cat-card[data-cat="\${activeCat}"]\`);
        if (card) card.classList.add("active");
      }

      renderTroubleshooting();
    }

    function renderTroubleshooting(){
      const container = document.getElementById("issues");
      if (!container) return;

      const data = TROUBLE_CACHE || [];
      const filtered = data.filter(item => {
        const catOK = (activeCat === "all") ? true : item.category === activeCat;
        if (!catOK) return false;

        if (!searchQ) return true;
        const t = (item.title || "").toLowerCase();
        const b = (item.solution || "").toLowerCase();
        return t.includes(searchQ) || b.includes(searchQ);
      });

      if (!filtered.length){
        container.innerHTML = `<div class="empty">No matching entries yet.</div>`;
        return;
      }

      container.innerHTML = "";
      filtered.forEach((issue) => {
        const block = document.createElement("div");
        block.className = "issue-block";

        const btn = document.createElement("button");
        btn.className = "issue-title";
        btn.type = "button";

        const left = document.createElement("div");
        left.textContent = issue.title || "Untitled fix";

        const chev = document.createElement("div");
        chev.className = "chev";
        chev.textContent = "▾";

        btn.appendChild(left);
        btn.appendChild(chev);

        const body = document.createElement("div");
        body.className = "issue-body";
        body.innerHTML = issue.solution || "";

        btn.addEventListener("click", () => {
          const open = body.classList.toggle("open");
          chev.style.transform = open ? "rotate(180deg)" : "rotate(0deg)";
          if (open) addCopyButtons(body);
        });

        block.appendChild(btn);
        block.appendChild(body);
        container.appendChild(block);
      });
    }

    /**********************
     * Init
     **********************/
    syncHeaderHeight();
    buildSixItemNav();
    openTab("guide");
    // If user loads with hash, keep it smooth + correct offset
    window.addEventListener("load", () => {
      syncHeaderHeight();
      const id = (location.hash || "").replace("#", "");
      if (id){
        const el = document.getElementById(id);
        if (el){
          setTimeout(() => scrollToWithOffset(el), 40);
        }
      }
    });
  </script>
</body>
</html>



